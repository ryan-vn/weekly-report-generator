<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多项目添加测试</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .project-item { background: #f5f5f5; padding: 10px; margin: 5px 0; border-radius: 3px; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; }
        input { padding: 8px; width: 300px; }
    </style>
</head>
<body>
    <h1>多项目添加测试</h1>
    
    <div class="test-section">
        <h3>测试添加项目</h3>
        <input type="text" id="projectInput" placeholder="输入项目路径" value="/Users/vincent/project/test-project">
        <button onclick="addProject()">添加项目</button>
        <button onclick="clearProjects()">清空项目</button>
        <button onclick="showProjects()">显示项目列表</button>
    </div>

    <div class="test-section">
        <h3>项目列表 (<span id="projectCount">0</span> 个项目)</h3>
        <div id="projectList">
            <div class="empty-state">暂无项目</div>
        </div>
    </div>

    <div class="test-section">
        <h3>控制台日志</h3>
        <div id="consoleLog" style="background: #f0f0f0; padding: 10px; height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
    </div>

    <script>
        let projectPaths = [];

        // 重写 console.log 来显示在页面上
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logDiv = document.getElementById('consoleLog');
            logDiv.innerHTML += args.join(' ') + '<br>';
            logDiv.scrollTop = logDiv.scrollHeight;
        };

        function addProject() {
            const input = document.getElementById('projectInput');
            const path = input.value.trim();

            console.log('尝试添加项目:', path);
            console.log('当前项目列表:', projectPaths);

            if (!path) {
                alert('请输入项目路径');
                return;
            }

            if (projectPaths.includes(path)) {
                alert('该项目已添加');
                return;
            }

            projectPaths.push(path);
            input.value = '';
            console.log('添加后的项目列表:', projectPaths);
            renderProjects();
        }

        function clearProjects() {
            projectPaths = [];
            console.log('清空项目列表');
            renderProjects();
        }

        function showProjects() {
            console.log('当前项目列表:', projectPaths);
        }

        function removeProject(index) {
            projectPaths.splice(index, 1);
            console.log('删除项目，新列表:', projectPaths);
            renderProjects();
        }

        function renderProjects() {
            const container = document.getElementById('projectList');
            const projectCount = document.getElementById('projectCount');

            projectCount.textContent = projectPaths.length;

            if (projectPaths.length === 0) {
                container.innerHTML = '<div class="empty-state">暂无项目</div>';
                return;
            }

            container.innerHTML = '';
            projectPaths.forEach((path, index) => {
                const item = document.createElement('div');
                item.className = 'project-item';
                const projectName = path.split('/').pop() || path;
                item.innerHTML = `
                    <span title="${path}">📁 ${projectName}</span>
                    <button onclick="removeProject(${index})">删除</button>
                `;
                container.appendChild(item);
            });
        }

        // 页面加载时显示初始状态
        console.log('页面加载完成');
        renderProjects();
    </script>
</body>
</html>
